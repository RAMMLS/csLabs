## Потоки

```cs
pt.Abort();
pt.Join();
```

Join(); - ожидание окончания работы программы

Как только вызывается функция Abort(); - ставит ОС "на уши?"

Система вырабатывает исключения:

```cs
ThreadAbortException
```


При вызове метода для Abort завершения потока система создает исключение ThreadAbortException
```cs
Thread.ResetAbort();
```

**Это касается аварийного завершения работы программы.**

	В наших интересах сделать так чтобы потоки не завершались аварийно!


# Класс Mutex

**Mutex** - это примитив синхронизации, предоставляющий эксклюзивный доступ к общему ресурсу только одному потоку. Если поток получает Mutex, второй поток, желающий получить этот Mutex, приостанавливается до тех пор, пока первый поток не освободит Mutex.


- Для того чтобы получить Mutex, в коде программы следует вызвать метод WaitOne() || WaitOne(int time) для этого Mutex
- Метод WaitOne() ожидает до тех пор, пока не будет получен Mutex, для которого он был вызван. Следовательно, этот метод блокирует выполнение вызывающего потока до тех пор, пока не станет доступным указанный Mutex. Он всегда возвращает логическое значение true.
- Когда же в коде больше не требуется владеть Mutex, он освобождается посредством вызова метода ReleaseMutex().

Поток вызывает WaitOne(int32) метод для получения Mutex.

Если интервал времени ожидания истекает, метод возвращает false, а поток не получает Mutex и не получает доступ к ресурсу, который защищает Mutex.

Пока поток не получил владение Mutex, он не должен вызывать метод ReleaseMutex.

ReleaseMutex вызывается только потоком, который получает Mutex.


```cs
private static Mutex mut = new Mutex();
//
//
//
mut.WaitOne();
//
//
//
mut.ReleaseMutex();
```

## Конструкторы Mutex 

- Mutex() - инициализирует новый экземпляр класса Mutex() стандартными свойствами.
- Mutex(Boolean) - инициализирует новый экземпляр класса Mutex логическим значением, указывающим, является ли вызывающий поток изначальным владельцем Mutex. (true - владелец/false - нет)

- Mutex(Boolean, String) - инициализирует новый экземпляр класса Mutex с логическим значением, показывающим необходимость наличия начального владения **Mutex** у вызывающего потока, и строкой, являющейся именем **Mutex**

## Семафор

- Semaphore(int32, int32) - инициализирует новый экземпляр класса Semaphore(), задающий начальное кол-во входов и максимальное кол-во одновременных входов.

- Semaphore(int32, int32, String) - инициализирует новый экземпляр класса Semaphore, задающий начальное кол-во входов и максимальное кол-во одновременных входов, а также при необходимости имя объекта системного семафора.

Потоки вводят семафор, вызывая WaitOne, который наследуется WaitHandle от класса, и освобождает семафор, вызывая метод Release.

Счетчик для семафора уменьшается каждый раз, когда поток входит в семафор, и увеличивается, когда поток освобождает семафор. Если значение счетчика равно нулю, последующие запросы блокируются до освобождения семафора другими потоками.

Когда семафор освобожден всеми потоками, счетчик будет иметь максимальное значение, указанное при создании семафора.

